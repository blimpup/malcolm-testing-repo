hooks:
  all:
    pre:
      - type: run
        cmd: ['find', '/usr/local', '-name', 'cdktf']
      - type: run
        cmd: ['find', '/usr/local', '-name', '*constructs*']
      - type: run
        cmd: ['npm', 'root', '-g']
      - type: env
        name: NODE_PATH
        cmd: ['echo', '/usr/local/node-v18.14.0-linux-x64/lib/node_modules/cdktf-cli/node_modules']
      - type: env
        name: PATH
        cmd: ['echo', '${PATH}:/usr/local/node-v18.14.0-linux-x64/bin/']
      - type: run
        cmd: ['which', 'cdktf']
      # - type: run
      #   cmd: ['npm', 'install', '-g', 'cdktf-cli@latest']
      # - type: run
      #   cmd: ['which', 'cdktf']
workflows:
  - tag_query: cdktf
    cdktf: true
dirs:
  '**/main.ts':
    tags: [cdktf]
    when_modified:
      file_patterns: ['${DIR}/*.ts']
    stacks:
      'cdktf-stack':
        tags: []
